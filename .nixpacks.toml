# âœ… CRITICAL: Force Node.js runtime (Railway was detecting Deno)
# Railway auto-detects Deno from supabase/functions/tts/deno.json
# This config explicitly forces Node.js instead

[phases.setup]
nixPkgs = ["nodejs_22", "npm-9_x", "openssl"]
# Explicitly install Node.js and npm to PATH
cmds = ["export PATH=$PATH:/nix/var/nix/profiles/default/bin"]

[phases.install]
cmds = ["npm install --legacy-peer-deps"]

[phases.build]
cmds = ["rm -rf dist node_modules/.vite && npm install --legacy-peer-deps && npm run build && echo '=== BUILD VERIFICATION ===' && ls -la dist/assets/index-*.js && echo '=== BUNDLE CREATED ===' && cat dist/index.html | grep -o 'index-[^.]*\\.js' | head -1"]

[start]
cmd = "npm run backend"











